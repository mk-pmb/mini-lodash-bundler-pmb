<!DOCTYPE html><html><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>test namespace pollution</title>
  <meta http-equiv="Content-Script-Type" content="text/javascript">
</head><body>

<script src="test-log.js"></script>
<script>
/*jslint indent: 2, maxlen: 80, browser: true */
(function () {
  'use strict';
  var log = window.log, usc = '_';

  window.define = function () {
    var args = Array.prototype.slice.call(arguments);
    log('define():', args);
  };
  window.define.amd = {};

  window.reportVars = function (stage) {
    log('vars @ ' + stage + ':');
    log('        _ = ', window[usc]);
    log('   lodash = ', window.lodash);
    log('  compile = ', window.compileLodash);
    log();
  };
  window.reportVars('init');
  window.module = { exports: {} };
}());
</script>

<script src="../build/cache/compile.cjs.min.js"></script>
<script>
/*jslint indent: 2, maxlen: 80, browser: true */
(function () {
  'use strict';
  var log = window.log, ld, compile = window.module.exports;

  window.reportVars('loaded');

  window.define('TEST', { TEST: true });
  ld = (function wrapCompile() { return compile(); }());
  log('compile result:', ld);
  log();

  window.reportVars('compiled');
}());
</script>

</body></html>